<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>One World One Centre — Intake Wizard & Yellow Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- html2pdf bundle -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <style>
    /* small helpers */
    .field-gap{gap:12px}
    .disabled-input{background:#f3f4f6;color:#6b7280}
    /* final yellow sheet styling */
    .yellow-bg{background:#FFF9C4}
    .checkbox-box{display:inline-block;width:20px;height:20px;border:1px solid #111;text-align:center;line-height:18px;font-weight:700;margin-right:6px}
    .muted{color:#6b7280}
    @media print{
      body{margin:0}
      .wizard{display:none}
      .final-wrap{display:block}
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800">
  <div class="max-w-5xl mx-auto p-6">

    <!-- WIZARD (pages 1-6) - kept exactly like your original structure -->
    <div id="wizardRoot" class="wizard bg-white rounded-lg shadow p-6">
      <h1 class="text-xl font-semibold mb-4">INFORMATION NEEDED FOR BOOKING APPOINTMENTS — Wizard</h1>

      <!-- PAGE 1 -->
      <section class="page" data-step="1">
        <h2 class="font-medium mb-3">Step 1 — Contact & Intake</h2>
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-2">
            <label class="block text-sm">DATE</label>
            <input id="date" type="date" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-3">
            <label class="block text-sm">TAKEN BY</label>
            <input id="takenBy" type="text" class="w-full border rounded p-2 mt-1" placeholder="Name" />
          </div>
          <div class="col-span-4">
            <label class="block text-sm">CONTACT NAME / SURNAME</label>
            <input id="contactName" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-2">
            <label class="block text-sm">CONTACT PHONE #</label>
            <input id="contactPhone" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-1">
            <label class="block text-sm">RELATION</label>
            <input id="contactRel" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
        </div>

        <div class="flex justify-end mt-4">
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="goTo(2)">Next</button>
        </div>
      </section>

      <!-- PAGE 2 -->
      <section class="page hidden" data-step="2">
        <h2 class="font-medium mb-3">Step 2 — Immigration & Attendance</h2>

        <div class="grid grid-cols-12 gap-3 mb-3">
          <div class="col-span-6">
            <label class="block text-sm">STUDENT'S STATUS</label>
            <div class="mt-1 flex flex-wrap gap-3 items-center">
              <label class="inline-flex items-center"><input type="radio" name="studentStatus" value="PR" class="mr-2">PR</label>
              <label class="inline-flex items-center"><input type="radio" name="studentStatus" value="RC" class="mr-2">RC</label>
              <label class="inline-flex items-center"><input type="radio" name="studentStatus" value="SP" class="mr-2">SP</label>
              <label class="inline-flex items-center"><input type="radio" name="studentStatus" value="WP" class="mr-2">WP</label>
              <label class="inline-flex items-center"><input type="radio" name="studentStatus" value="Other" class="mr-2" onchange="toggleOtherField('studentStatusOther', this)">Other</label>
              <input id="studentStatusOther" type="text" class="hidden border rounded p-2" placeholder="Specify" />
            </div>
          </div>

          <div class="col-span-6">
            <label class="block text-sm">IMMIGRATION DOCUMENT (OF NATURAL PARENT / GUARDIAN)</label>
            <div class="mt-1 flex flex-wrap gap-3 items-center">
              <label class="inline-flex items-center"><input type="radio" name="immDoc" value="PR" class="mr-2">PR</label>
              <label class="inline-flex items-center"><input type="radio" name="immDoc" value="RC" class="mr-2">RC</label>
              <label class="inline-flex items-center"><input type="radio" name="immDoc" value="SP" class="mr-2">SP</label>
              <label class="inline-flex items-center"><input type="radio" name="immDoc" value="WP" class="mr-2">WP</label>
              <label class="inline-flex items-center"><input type="radio" name="immDoc" value="Other" class="mr-2" onchange="toggleOtherField('immDocOther', this)">Other</label>
              <input id="immDocOther" type="text" class="hidden border rounded p-2" placeholder="Specify" />
            </div>
          </div>

          <div class="col-span-4 mt-2">
            <label class="block text-sm">EXPIRY DATE (RC / SP / WP)</label>
            <input id="expiry" type="date" class="w-full border rounded p-2 mt-1" />
          </div>

          <div class="col-span-8 mt-2">
            <label class="block text-sm">PREVIOUS ATTENDANCE IN CANADIAN SCHOOLS?</label>
            <div class="mt-1 flex items-center gap-6">
              <label class="inline-flex items-center"><input type="radio" name="prevAttend" value="No" onchange="toggleAttendance(false)" class="mr-2">No</label>
              <label class="inline-flex items-center"><input type="radio" name="prevAttend" value="Yes" onchange="toggleAttendance(true)" class="mr-2">Yes</label>
            </div>
            <input id="prevDetails" type="text" class="mt-2 w-full border rounded p-2 disabled-input" placeholder="If Yes: Where / Grade / For how long" disabled />
          </div>

          <div class="col-span-12 mt-2">
            <label class="block text-sm">DATE STUDENT(S) LANDED IN CANADA</label>
            <input id="landed" type="date" class="w-full border rounded p-2 mt-1" />
          </div>
        </div>

        <div class="flex justify-between">
          <button class="px-4 py-2 bg-gray-500 text-white rounded" onclick="goTo(1)">Back</button>
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="goTo(3)">Next</button>
        </div>
      </section>

      <!-- PAGE 3 Parents -->
      <section class="page hidden" data-step="3">
        <h2 class="font-medium mb-3">Step 3 — Parent / Guardian</h2>
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-3">
            <label class="block text-sm">FATHER'S SURNAME</label>
            <input id="fatherSurname" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-3">
            <label class="block text-sm">FATHER'S GIVEN NAME</label>
            <input id="fatherGiven" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-3">
            <label class="block text-sm">MOTHER'S SURNAME</label>
            <input id="motherSurname" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-3">
            <label class="block text-sm">MOTHER'S GIVEN NAME</label>
            <input id="motherGiven" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
        </div>
        <div class="flex justify-between mt-4">
          <button class="px-4 py-2 bg-gray-500 text-white rounded" onclick="goTo(2)">Back</button>
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="goTo(4)">Next</button>
        </div>
      </section>

      <!-- PAGE 4 Address & family -->
      <section class="page hidden" data-step="4">
        <h2 class="font-medium mb-3">Step 4 — Address & Family</h2>
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-2">
            <label class="block text-sm">APARTMENT #</label>
            <input id="apt" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-8">
            <label class="block text-sm">FAMILY ADDRESS</label>
            <input id="address" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-2">
            <label class="block text-sm">POSTAL CODE</label>
            <input id="postal" type="text" class="w-full border rounded p-2 mt-1" />
          </div>

          <div class="col-span-4 mt-2">
            <label class="block text-sm">FAMILY PHONE #</label>
            <input id="familyPhone" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-4 mt-2">
            <label class="block text-sm">HOME LANGUAGE</label>
            <input id="homeLang" type="text" class="w-full border rounded p-2 mt-1" />
          </div>
          <div class="col-span-4 mt-2">
            <label class="block text-sm">CATHOLIC</label>
            <div class="mt-1 flex items-center gap-6">
              <label class="inline-flex items-center"><input type="radio" name="catholic" value="No" class="mr-2">No</label>
              <label class="inline-flex items-center"><input type="radio" name="catholic" value="Yes" class="mr-2">Yes</label>
            </div>
          </div>
        </div>

        <div class="flex justify-between mt-4">
          <button class="px-4 py-2 bg-gray-500 text-white rounded" onclick="goTo(3)">Back</button>
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="goTo(5)">Next</button>
        </div>
      </section>

      <!-- PAGE 5 Students (dynamic add) -->
      <section class="page hidden" data-step="5">
        <h2 class="font-medium mb-3">Step 5 — Student Details (Add as many as needed)</h2>
        <div id="studentsContainer" class="space-y-4">
          <!-- template inserted by JS -->
        </div>
        <div class="flex items-center gap-3 mt-3">
          <button class="px-3 py-2 bg-blue-600 text-white rounded" onclick="addStudent()" type="button">Add Student</button>
          <button class="px-3 py-2 bg-red-500 text-white rounded" onclick="removeStudent()" type="button">Remove Last</button>
        </div>

        <div class="flex justify-between mt-4">
          <button class="px-4 py-2 bg-gray-500 text-white rounded" onclick="goTo(4)">Back</button>
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="goTo(6)">Next</button>
        </div>
      </section>

      <!-- PAGE 6 Schooling profile & notes -->
      <section class="page hidden" data-step="6">
        <h2 class="font-medium mb-3">Step 6 — Schooling Profile & Notes</h2>
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-4">
            <label class="block text-sm">POTENTIAL LIMITED FORMAL SCHOOLING PROFILE</label>
            <div class="mt-1 flex items-center gap-6">
              <label class="inline-flex items-center"><input type="radio" name="limitedProfile" value="No">No</label>
              <label class="inline-flex items-center"><input type="radio" name="limitedProfile" value="Yes">Yes</label>
            </div>
          </div>
          <div class="col-span-8">
            <label class="block text-sm">DETAILS (Number of years as refugees, country of relocation, refugee camp name, nature of schooling, parent country of origin)</label>
            <textarea id="notes" class="w-full border rounded p-2 mt-1" placeholder="Describe if relevant"></textarea>
          </div>
        </div>

        <div class="flex justify-between mt-4">
          <button class="px-4 py-2 bg-gray-500 text-white rounded" onclick="goTo(5)">Back</button>
          <button class="px-4 py-2 bg-green-700 text-white rounded" onclick="generateFinal()">Generate Yellow Form</button>
        </div>
      </section>

    </div> <!-- end wizardRoot -->

    <!-- FINAL STATIC YELLOW FORM -->
    <div id="finalWrap" class="final-wrap hidden mt-6">
      <div id="finalArea" class="yellow-bg p-6 rounded shadow border">
        <!-- final yellow table injected here -->
      </div>

      <div class="mt-4 flex gap-3">
        <button id="printBtn" class="px-4 py-2 bg-blue-600 text-white rounded" onclick="window.print()">Print</button>
        <button id="pdfBtn" class="px-4 py-2 bg-indigo-600 text-white rounded">Download PDF</button>
        <button id="editBtn" class="px-4 py-2 bg-gray-500 text-white rounded">Back to Edit</button>
      </div>
    </div>

  </div> <!-- container -->

  <script>
    // --- Wizard navigation ---
    function goTo(step){
      document.querySelectorAll('.page').forEach(p=>p.classList.add('hidden'))
      const target = document.querySelector(`.page[data-step='${step}']`)
      if(target) target.classList.remove('hidden')
      window.scrollTo({top:0,behavior:'smooth'})
    }

    // --- toggle Other text fields for radio groups ---
    function toggleOtherField(id, el){
      const inp = document.getElementById(id)
      if(el.value === 'Other' && el.checked){ inp.classList.remove('hidden'); inp.focus() } else { inp.classList.add('hidden'); inp.value = '' }
    }

    // --- Attendance enabling/disabling ---
    function toggleAttendance(isYes){
      const d = document.getElementById('prevDetails')
      if(isYes){ d.disabled = false; d.classList.remove('disabled-input') } else { d.disabled = true; d.classList.add('disabled-input'); d.value = '' }
    }

    // --- Dynamic students ---
    let studentCount = 0
    function addStudent(prefill){
      studentCount++
      const id = studentCount
      const container = document.getElementById('studentsContainer')
      const wrap = document.createElement('div')
      wrap.className = 'p-4 border rounded bg-gray-50'
      wrap.id = `student-${id}`
      wrap.innerHTML = `
        <div class="grid grid-cols-12 gap-3">
          <div class="col-span-3">
            <label class="text-sm">STUDENT'S SURNAME</label>
            <input type="text" id="s_${id}_surname" class="w-full border rounded p-2 mt-1" value="${prefill?.surname||''}" />
          </div>
          <div class="col-span-3">
            <label class="text-sm">STUDENT'S GIVEN NAME</label>
            <input type="text" id="s_${id}_given" class="w-full border rounded p-2 mt-1" value="${prefill?.given||''}" />
          </div>
          <div class="col-span-2">
            <label class="text-sm">GENDER</label>
            <div class="mt-1 flex items-center gap-3">
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_gender" value="F" class="mr-2">F</label>
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_gender" value="M" class="mr-2">M</label>
            </div>
          </div>
          <div class="col-span-2">
            <label class="text-sm">DOB</label>
            <input type="date" id="s_${id}_dob" class="w-full border rounded p-2 mt-1" value="${prefill?.dob||''}" />
          </div>
          <div class="col-span-2">
            <label class="text-sm">BIRTH COUNTRY</label>
            <input type="text" id="s_${id}_birth" class="w-full border rounded p-2 mt-1" value="${prefill?.birth||''}" />
          </div>

          <div class="col-span-4 mt-2">
            <label class="text-sm">LAST GRADE COMPLETED</label>
            <input type="text" id="s_${id}_lastgrade" class="w-full border rounded p-2 mt-1" value="${prefill?.lastgrade||''}" />
          </div>
          <div class="col-span-4 mt-2">
            <label class="text-sm">SCHOOL YEAR</label>
            <div class="mt-1 flex items-center gap-3">
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_year" value="ThisYear" class="mr-2">This year</label>
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_year" value="NextYear" class="mr-2">Next year</label>
            </div>
          </div>
          <div class="col-span-4 mt-2">
            <label class="text-sm">PROGRAM</label>
            <div class="mt-1 flex items-center gap-3">
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_prog" value="No" class="mr-2">No</label>
              <label class="inline-flex items-center"><input type="radio" name="s_${id}_prog" value="Yes" class="mr-2">Yes</label>
              <input type="text" id="s_${id}_prog_spec" class="border rounded p-2 ml-2" placeholder="Specify (if Yes)" />
            </div>
          </div>
        </div>
      `
      container.appendChild(wrap)
      window.scrollTo({top:wrap.offsetTop-60, behavior:'smooth'})
    }
    function removeStudent(){ if(studentCount===0) return; const el=document.getElementById(`student-${studentCount}`); if(el) el.remove(); studentCount-- }

    // start with 1 student by default
    addStudent()

    // --- Build final static yellow form (table-based output) ---
    function checkboxMark(cond){ return cond ? '☑' : '☐' }

    function getRadioValue(name){ const r=document.querySelector(`input[name='${name}']:checked`); return r? r.value : '' }

    function escapeHtml(str) {
      if (!str) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    function generateFinal(){
      const final = document.getElementById('finalArea')
      final.innerHTML = ''

      // top-level table
      const tbl = document.createElement('table')
      tbl.className = 'w-full border-collapse text-sm'
      tbl.style.border = "1px solid #000"

      function addRow(label, col1, label2, col2, mutedCol1){
        const tr = document.createElement('tr')
        tr.innerHTML = `
          <td class="p-2 border font-semibold w-40 align-top">${label}</td>
          <td class="p-2 border ${mutedCol1? 'muted':''}">${col1||''}</td>
          <td class="p-2 border font-semibold w-40 align-top">${label2||''}</td>
          <td class="p-2 border">${col2||''}</td>
        `
        tbl.appendChild(tr)
      }

      // Top info rows
      addRow('DATE', escapeHtml(document.getElementById('date').value), 'TAKEN BY', escapeHtml(document.getElementById('takenBy').value))
      addRow('CONTACT NAME/SURNAME', escapeHtml(document.getElementById('contactName').value), 'CONTACT PHONE #', escapeHtml(document.getElementById('contactPhone').value))
      addRow('CONTACT RELATIONSHIP', escapeHtml(document.getElementById('contactRel').value), '', '')

      // immigration / attendance
      const sStatus = getRadioValue('studentStatus')
      const imm = getRadioValue('immDoc')
      addRow("STUDENT'S STATUS", escapeHtml(sStatus), 'IMMIGRATION DOCUMENT (OF NATURAL PARENT/GUARDIAN)', escapeHtml(imm))

      addRow('EXPIRY DATE (RC/SP/WP)', escapeHtml(document.getElementById('expiry').value), 'PREVIOUS ATTENDANCE IN CANADIAN SCHOOLS?', (function(){
        const val = getRadioValue('prevAttend')
        if(val==='Yes') return `${checkboxMark(true)} Yes   ${checkboxMark(false)} No`
        if(val==='No') return `${checkboxMark(false)} Yes   ${checkboxMark(true)} No`
        return ''
      })())

      addRow('DATE STUDENT(S) LANDED IN CANADA', escapeHtml(document.getElementById('landed').value), 'PREVIOUS DETAILS', (document.getElementById('prevDetails') && document.getElementById('prevDetails').value) ? escapeHtml(document.getElementById('prevDetails').value) : (document.getElementById('prevDetails') && document.getElementById('prevDetails').disabled ? '—':''))

      addRow("FATHER'S SURNAME", escapeHtml(document.getElementById('fatherSurname').value), "FATHER'S GIVEN NAME", escapeHtml(document.getElementById('fatherGiven').value))
      addRow("MOTHER'S SURNAME", escapeHtml(document.getElementById('motherSurname').value), "MOTHER'S GIVEN NAME", escapeHtml(document.getElementById('motherGiven').value))

      addRow('APARTMENT #', escapeHtml(document.getElementById('apt').value), 'FAMILY ADDRESS', escapeHtml(document.getElementById('address').value) + (document.getElementById('postal').value? ' / '+escapeHtml(document.getElementById('postal').value) : ''))
      addRow('FAMILY PHONE #', escapeHtml(document.getElementById('familyPhone').value), 'HOME LANGUAGE', escapeHtml(document.getElementById('homeLang').value) + '  ' + (function(){ const c=getRadioValue('catholic'); return c? (checkboxMark(c==='Yes')+' Yes   '+checkboxMark(c==='No')+' No') : '' })())

      // STUDENT BLOCK (nested table for consistent layout)
      const studentRow = document.createElement('tr')
      const studentCell = document.createElement('td')
      studentCell.colSpan = 4
      studentCell.className = 'p-0 border'

      const studentTable = document.createElement('table')
      studentTable.className = 'w-full border-collapse text-sm'
      studentTable.style.border = "1px solid #000"

      // student header (8 columns)
      const sHead = document.createElement('tr')
      sHead.innerHTML = `
        <th class="p-2 border font-semibold w-32">STUDENT'S SURNAME</th>
        <th class="p-2 border font-semibold w-32">STUDENT'S GIVEN NAME</th>
        <th class="p-2 border font-semibold w-16">GENDER</th>
        <th class="p-2 border font-semibold w-28">DOB (MMM/DD/YYYY)</th>
        <th class="p-2 border font-semibold w-28">BIRTH COUNTRY</th>
        <th class="p-2 border font-semibold w-28">LAST GRADE COMPLETED</th>
        <th class="p-2 border font-semibold w-28">SCHOOL YEAR</th>
        <th class="p-2 border font-semibold w-28">PROGRAM</th>
      `
      studentTable.appendChild(sHead)

      // each student row
      for(let i=1;i<=studentCount;i++){
        const surname = document.getElementById(`s_${i}_surname`)?.value || ''
        const given = document.getElementById(`s_${i}_given`)?.value || ''
        const gender = (function(){ const g = document.querySelector(`input[name='s_${i}_gender']:checked`); return g? g.value : '' })()
        const dob = document.getElementById(`s_${i}_dob`)?.value || ''
        const birth = document.getElementById(`s_${i}_birth`)?.value || ''
        const last = document.getElementById(`s_${i}_lastgrade`)?.value || ''
        const year = (function(){ const y = document.querySelector(`input[name='s_${i}_year']:checked`); return y? y.value : '' })()
        const prog = (function(){ const p = document.querySelector(`input[name='s_${i}_prog']:checked`); return p? p.value : '' })()
        const progSpec = document.getElementById(`s_${i}_prog_spec`)?.value || ''

        // only show if there's content for that student
        if(surname || given || birth || last){
          const row = document.createElement('tr')
          row.innerHTML = `
            <td class="p-2 border">${escapeHtml(surname)}</td>
            <td class="p-2 border">${escapeHtml(given)}</td>
            <td class="p-2 border text-center">${checkboxMark(gender==='F')} F&nbsp;&nbsp;${checkboxMark(gender==='M')} M</td>
            <td class="p-2 border text-center">${escapeHtml(dob)}</td>
            <td class="p-2 border">${escapeHtml(birth)}</td>
            <td class="p-2 border text-center">${escapeHtml(last)}</td>
            <td class="p-2 border text-center">${year==='ThisYear' ? 'This year' : (year==='NextYear' ? 'Next year' : '')}</td>
            <td class="p-2 border text-center">${prog==='Yes' ? 'Yes — '+escapeHtml(progSpec) : (prog==='No' ? 'No' : '')}</td>
          `
          studentTable.appendChild(row)
        }
      }

      studentCell.appendChild(studentTable)
      studentRow.appendChild(studentCell)
      tbl.appendChild(studentRow)

      // limited profile + notes + rev
      const limited = getRadioValue('limitedProfile')
      const trLimited = document.createElement('tr')
      trLimited.innerHTML = `
        <td class="p-2 border font-semibold" colspan="2">
          POTENTIAL LIMITED FORMAL SCHOOLING PROFILE
        </td>
        <td class="p-2 border" colspan="2">
          ${checkboxMark(limited==='Yes')} Yes&nbsp;&nbsp;${checkboxMark(limited==='No')} No
          <div class="text-xs italic mt-1">If YES, describe for each student, Grade 1 – Grade 12, as relevant. Number of years as refugees, country of relocation, refugee camp name, nature of schooling, parent country of origin.</div>
        </td>
      `
      tbl.appendChild(trLimited)

      const trNotes = document.createElement('tr')
      trNotes.innerHTML = `
        <td class="p-2 border font-semibold" colspan="2">NOTES</td>
        <td class="p-2 border" colspan="2" style="height:80px; vertical-align:top;">${escapeHtml(document.getElementById('notes').value)}</td>
      `
      tbl.appendChild(trNotes)

      const trRev = document.createElement('tr')
      trRev.innerHTML = `
        <td class="p-2 border text-xs italic text-right" colspan="4">Rev. 2021</td>
      `
      tbl.appendChild(trRev)

      final.appendChild(tbl)

      // show final and hide wizard
      document.getElementById('wizardRoot').classList.add('hidden')
      document.getElementById('finalWrap').classList.remove('hidden')

      // pdf button logic
      document.getElementById('pdfBtn').onclick = ()=>{
        const opt = { margin:0.2, filename:'one-world-one-centre-intake.pdf', image:{type:'jpeg',quality:0.98}, html2canvas:{scale:2}, jsPDF:{unit:'in',format:'letter',orientation:'portrait'} }
        html2pdf().set(opt).from(document.getElementById('finalArea')).save()
      }

      // edit/back button
      document.getElementById('editBtn').onclick = ()=>{
        document.getElementById('wizardRoot').classList.remove('hidden')
        document.getElementById('finalWrap').classList.add('hidden')
        window.scrollTo({top:0,behavior:'smooth'})
      }
    }

    // Expose generate function for the button and ensure print button works (print uses browser)
    window.generateFinal = generateFinal

  </script>
</body>
</html>
