<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>One World One Centre — Intake Wizard & Yellow Form</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <!-- jQuery + Select2 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

  <style>
    .field-gap { gap: 12px; }
    .disabled-input { background: #f3f4f6; color: #6b7280; }
    .yellow-bg { background: #FFF9C4; }
    .checkbox-box {
      display:inline-block;width:20px;height:20px;border:1px solid #111;
      text-align:center;line-height:18px;font-weight:700;margin-right:6px;
    }
    .muted { color:#6b7280; }

    table.yellow-table, table.yellow-table td, table.yellow-table th {
      border: 1px solid #000 !important;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    table.yellow-table td, table.yellow-table th { padding: 6px; vertical-align: top; }

    @media print {
      body { margin:0 }
      .wizard { display:none }
      .final-wrap { display:block }
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800">
  <div class="max-w-5xl mx-auto p-6">

    <!-- ========================================== -->
    <!--   WIZARD SECTION (Pages 1 to 6)            -->
    <!-- ========================================== -->
    <div id="wizardRoot" class="wizard bg-white rounded-lg shadow p-6">
      <h1 class="text-xl font-semibold mb-4">
        INFORMATION NEEDED FOR BOOKING APPOINTMENTS AND SENDING REQUESTS
      </h1>

      <!-- PAGE 1 -->
      <section class="page" data-step="1">
        <h2 class="text-lg font-bold mb-3">Page 1 — Family Information</h2>

        <div class="mb-4">
          <label class="block font-semibold">Family Name:</label>
          <input type="text" id="familyName" class="border rounded w-full p-2" />
        </div>

        <div class="mb-4">
          <label class="block font-semibold">Number of Children:</label>
          <input type="number" id="numChildren" min="0" class="border rounded w-full p-2" />
        </div>

        <div class="mt-6 flex justify-between">
          <button disabled class="px-4 py-2 bg-gray-300 rounded">Back</button>
          <button onclick="goTo(2)" class="px-4 py-2 bg-blue-600 text-white rounded">Next</button>
        </div>
      </section>

      <!-- PAGE 2 -->
      <section class="page hidden" data-step="2">
        <h2 class="text-lg font-bold mb-3">Page 2 — Contact Details</h2>

        <div class="mb-4">
          <label class="block font-semibold">Phone Number:</label>
          <input type="text" id="phoneNumber" class="border rounded w-full p-2" placeholder="(123) 456-7890" />
        </div>

        <div class="mb-4">
          <label class="block font-semibold">Email Address:</label>
          <input type="email" id="email" class="border rounded w-full p-2" />
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="goTo(1)" class="px-4 py-2 bg-gray-500 text-white rounded">Back</button>
          <button onclick="goTo(3)" class="px-4 py-2 bg-blue-600 text-white rounded">Next</button>
        </div>
      </section>


      <!-- PAGE 3 -->
      <section class="page hidden" data-step="3">
        <h2 class="text-lg font-bold mb-3">Page 3 — Student Information</h2>

        <div id="studentsWrapper" class="mb-4">
          <p class="text-sm mb-2">Add information for each student in the family:</p>
          <div id="studentsList"></div>
        </div>

        <button type="button" onclick="addStudent()" 
          class="px-4 py-2 bg-green-600 text-white rounded mb-4">+ Add Student</button>

        <div class="mt-6 flex justify-between">
          <button onclick="goTo(2)" class="px-4 py-2 bg-gray-500 text-white rounded">Back</button>
          <button onclick="goTo(4)" class="px-4 py-2 bg-blue-600 text-white rounded">Next</button>
        </div>
      </section>

      <!-- PAGE 4 -->
      <section class="page hidden" data-step="4">
        <h2 class="text-lg font-bold mb-3">Page 4 — Immigration & Refugee Details</h2>

        <div class="mb-4">
          <label class="block font-semibold">Immigration Category:</label>
          <select id="immigrationCategory" class="border rounded w-full p-2">
            <option value="">Select...</option>
            <option value="Refugee">Refugee</option>
            <option value="Family Class">Family Class</option>
            <option value="Economic">Economic</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="mb-4">
          <label class="block font-semibold">If Refugee, describe:</label>
          <textarea id="refugeeDetails" class="border rounded w-full p-2" rows="3"
            placeholder="Number of years as refugees, country of relocation, refugee camp name, nature of schooling, parent country of origin"></textarea>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="goTo(3)" class="px-4 py-2 bg-gray-500 text-white rounded">Back</button>
          <button onclick="goTo(5)" class="px-4 py-2 bg-blue-600 text-white rounded">Next</button>
        </div>
      </section>

      <!-- PAGE 5 -->
      <section class="page hidden" data-step="5">
        <h2 class="text-lg font-bold mb-3">Page 5 — Schooling Information</h2>

        <div class="mb-4">
          <label class="block font-semibold">Has the student attended school in Canada?</label>
          <div class="flex items-center gap-4">
            <label><input type="radio" name="attendedCanada" value="Yes"> Yes</label>
            <label><input type="radio" name="attendedCanada" value="No"> No</label>
          </div>
        </div>

        <div id="schoolDetails" class="hidden mb-4">
          <label class="block font-semibold">If YES, provide details:</label>
          <textarea class="border rounded w-full p-2" rows="3"
            placeholder="School name, grade, years attended"></textarea>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="goTo(4)" class="px-4 py-2 bg-gray-500 text-white rounded">Back</button>
          <button onclick="goTo(6)" class="px-4 py-2 bg-blue-600 text-white rounded">Next</button>
        </div>
      </section>

      <!-- PAGE 6 -->
      <section class="page hidden" data-step="6">
        <h2 class="text-lg font-bold mb-3">Page 6 — Review & Submit</h2>

        <p class="mb-4">Please review all the information entered before generating the final Yellow Form.</p>

        <div class="flex justify-between">
          <button onclick="goTo(5)" class="px-4 py-2 bg-gray-500 text-white rounded">Back</button>
          <button onclick="generateYellowForm()" 
            class="px-4 py-2 bg-green-600 text-white rounded">Generate Yellow Form</button>
        </div>
      </section>
    </div> <!-- wizardRoot -->






    <!-- ========================================== -->
    <!--   YELLOW FORM SECTION (Final Output)       -->
    <!-- ========================================== -->
    <div id="finalWrap" class="final-wrap hidden mt-6">
      <div id="finalArea" class="yellow-bg p-6 rounded shadow border">
        <!-- Yellow form content will be injected here by JavaScript -->
      </div>

      <div class="mt-4 flex gap-3">
        <button id="printBtn" class="px-4 py-2 bg-blue-600 text-white rounded" onclick="window.print()">Print</button>
        <button id="pdfBtn" class="px-4 py-2 bg-indigo-600 text-white rounded">Download PDF</button>
        <button id="editBtn" class="px-4 py-2 bg-gray-500 text-white rounded" onclick="backToEdit()">Back to Edit</button>
      </div>
    </div>

  </div> <!-- container -->




  <!-- ========================================== -->
  <!--   SCRIPTS (Wizard + Yellow Form)           -->
  <!-- ========================================== -->
  <script>
    // ------------------------------
    // Navigation between wizard pages
    // ------------------------------
    function goTo(step){
      document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
      const target = document.querySelector(`.page[data-step='${step}']`);
      if(target) target.classList.remove('hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // ------------------------------
    // Add student form dynamically
    // ------------------------------
    let studentCount = 0;
    function addStudent(){
      studentCount++;
      const wrapper = document.getElementById("studentsList");
      const studentDiv = document.createElement("div");
      studentDiv.className = "border rounded p-4 mb-4";
      studentDiv.innerHTML = `
        <h3 class="font-semibold mb-2">Student ${studentCount}</h3>
        <label class="block">First Name:</label>
        <input type="text" class="border rounded w-full p-2 mb-2 studentFirst" />

        <label class="block">Last Name:</label>
        <input type="text" class="border rounded w-full p-2 mb-2 studentLast" />

        <label class="block">Grade:</label>
        <input type="text" class="border rounded w-full p-2 mb-2 studentGrade" />

        <label class="block">Date of Birth:</label>
        <input type="date" class="border rounded w-full p-2 mb-2 studentDOB" />
      `;
      wrapper.appendChild(studentDiv);
    }

    // ------------------------------
    // Toggle "Has attended school in Canada?"
    // ------------------------------
    document.querySelectorAll("input[name='attendedCanada']").forEach(radio => {
      radio.addEventListener("change", e => {
        if(e.target.value === "Yes"){
          document.getElementById("schoolDetails").classList.remove("hidden");
        } else {
          document.getElementById("schoolDetails").classList.add("hidden");
        }
      });
    });

    // ------------------------------
    // Generate the Yellow Form
    // ------------------------------
    function generateYellowForm(){
      const familyName = document.getElementById("familyName").value;
      const numChildren = document.getElementById("numChildren").value;
      const phone = document.getElementById("phoneNumber").value;
      const email = document.getElementById("email").value;
      const immigrationCategory = document.getElementById("immigrationCategory").value;
      const refugeeDetails = document.getElementById("refugeeDetails").value;

      let attendedCanada = document.querySelector("input[name='attendedCanada']:checked");
      attendedCanada = attendedCanada ? attendedCanada.value : "";
      let schoolDetails = "";
      if(attendedCanada === "Yes"){
        schoolDetails = document.querySelector("#schoolDetails textarea").value;
      }

      // Gather student data
      const students = [];
      document.querySelectorAll("#studentsList > div").forEach(div => {
        students.push({
          first: div.querySelector(".studentFirst").value,
          last: div.querySelector(".studentLast").value,
          grade: div.querySelector(".studentGrade").value,
          dob: div.querySelector(".studentDOB").value
        });
      });

      // Build Yellow Form HTML
      let html = `
        <h1 class="text-xl font-bold mb-4 text-center">YELLOW FORM</h1>
        <table class="yellow-table w-full mb-4">
          <tr><th class="w-1/3">Family Name</th><td>${familyName}</td></tr>
          <tr><th>Number of Children</th><td>${numChildren}</td></tr>
          <tr><th>Phone</th><td>${phone}</td></tr>
          <tr><th>Email</th><td>${email}</td></tr>
          <tr><th>Immigration Category</th><td>${immigrationCategory}</td></tr>
          <tr><th>Refugee Details</th><td>${refugeeDetails}</td></tr>
        </table>
      `;

      if(students.length > 0){
        html += `<h2 class="font-semibold mb-2">Students</h2>`;
        html += `<table class="yellow-table w-full mb-4">
          <tr><th>First Name</th><th>Last Name</th><th>Grade</th><th>DOB</th></tr>`;
        students.forEach(s => {
          html += `<tr>
            <td>${s.first}</td>
            <td>${s.last}</td>
            <td>${s.grade}</td>
            <td>${s.dob}</td>
          </tr>`;
        });
        html += `</table>`;
      }

      html += `
        <h2 class="font-semibold mb-2">Schooling</h2>
        <p><strong>Attended school in Canada?:</strong> ${attendedCanada}</p>
        <p><strong>Details:</strong> ${schoolDetails}</p>
      `;

      document.getElementById("finalArea").innerHTML = html;

      // Show Yellow Form, hide wizard
      document.getElementById("wizardRoot").classList.add("hidden");
      document.getElementById("finalWrap").classList.remove("hidden");
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // ------------------------------
    // Back to edit
    // ------------------------------
    function backToEdit(){
      document.getElementById("wizardRoot").classList.remove("hidden");
      document.getElementById("finalWrap").classList.add("hidden");
      goTo(1);
    }

    // ------------------------------
    // PDF Download
    // ------------------------------
    document.getElementById("pdfBtn").addEventListener("click", () => {
      const element = document.getElementById("finalArea");
      html2pdf().from(element).set({
        margin: 10,
        filename: 'YellowForm.pdf',
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      }).save();
    });
  </script>
</body>
</html>
